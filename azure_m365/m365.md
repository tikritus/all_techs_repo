# Microsoft 365: Important Log Sources for Cybersecurity

This document provides a list of crucial log sources from Microsoft 365 services, their typical locations, descriptions, and information regarding their retention periods, which is vital for cybersecurity investigations.

| Log Source                                      | M365 Service / Location                                                                 | Description                                                                                                                                                                                             | Retention Period                                                                                                                                                                                                                           |
|-------------------------------------------------|-----------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Unified Audit Log (UAL)** | Microsoft Purview compliance portal -> Audit                                            | Centralized log of user and admin activities across most M365 services (Exchange Online, SharePoint Online, OneDrive, Teams, Entra ID, Defender for Office 365, Power BI, etc.). Critical for investigations. | Default: 90 days (M365 E3/G3/F3/Business Premium). <br> 1 year (M365 E5/G5/F5, or with E5/G5/F5 Compliance/Audit add-on). <br> 10 years (with 10-year audit log retention add-on). <br> Can be exported via Office 365 Management Activity API. |
| **Microsoft Entra ID Logs (M365 Context)** | Microsoft Entra admin center (portal.azure.com) -> Monitoring (Sign-in, Audit, Provisioning) | User sign-ins, admin changes to Entra ID, application activity, device registration, group management relevant to M365 access. (Same logs as in Azure context but vital for M365).                  | Default: 30 days (P1/P2 licenses). <br> Free license: 7 days. <br> Can be exported to Azure Monitor Logs (Log Analytics) or Azure Storage for longer, configurable retention.                                                               |
| **Exchange Online Logs** |                                                                                         |                                                                                                                                                                                                         |                                                                                                                                                                                                                                          |
|   Mailbox Audit Logs                            | Microsoft Purview compliance portal (Audit search) / Exchange admin center / PowerShell | Tracks owner, delegate, and admin access and actions within specific mailboxes (e.g., message deletion, permission changes). Must be enabled per mailbox.                                             | Stored in the audited mailbox itself (Recoverable Items folder). Default: 90 days. <br> Can be extended up to 10 years with E5 or specific add-ons (via UAL).                                                                                 |
|   Admin Audit Log                               | Exchange admin center / PowerShell (`Search-AdminAuditLog`)                               | Records actions performed by administrators in Exchange Online using the Exchange admin center or PowerShell.                                                                                           | 90 days. Accessible via PowerShell or EAC reports.                                                                                                                                                                                           |
|   Message Tracking Logs                         | Exchange admin center (Mail flow -> Message trace) / PowerShell (`Get-MessageTrace`)      | Detailed information about email messages as they pass through Exchange Online (sender, recipient, status, timestamps, server hops).                                                                 | Real-time/Recent: 10 days (GUI). <br> Historical (up to 90 days): CSV export via GUI or PowerShell. <br> Extended Message Trace (with E5 or add-on): Up to 180 days via API/Purview.                                                            |
| **SharePoint Online & OneDrive for Business** |                                                                                         |                                                                                                                                                                                                         |                                                                                                                                                                                                                                          |
|   Site Usage Reports / Audit Log Reports      | Microsoft Purview compliance portal (Audit search) / SharePoint Site Settings           | Activities on files, folders, pages, permissions, sharing invitations, and site administration. (Primarily via Unified Audit Log).                                                                      | Same as Unified Audit Log retention.                                                                                                                                                                                                         |
|   Sharing Links Audit                           | Microsoft Purview compliance portal (Audit search)                                      | Records creation, modification, and use of sharing links.                                                                                                                                               | Same as Unified Audit Log retention.                                                                                                                                                                                                         |
| **Microsoft Teams Logs** |                                                                                         |                                                                                                                                                                                                         |                                                                                                                                                                                                                                          |
|   Teams Audit Logs                              | Microsoft Purview compliance portal (Audit search)                                      | User and admin activities in Teams, such as team creation/deletion, channel activity, membership changes, app installations, meeting events, chat events (for E5).                                  | Same as Unified Audit Log retention.                                                                                                                                                                                                         |
|   Teams Call Detail Records (CDR)               | Teams admin center -> Analytics & reports -> Usage reports / PowerShell                 | Detailed information about calls and meetings, including participants, duration, quality, and device information.                                                                                       | Teams Admin Center: Typically 30-90 days depending on the report. <br> For longer retention or detailed analysis, consider exporting data or using advanced communication solutions.                                                      |
| **Microsoft Defender for Office 365 Logs** | Microsoft Defender portal (XDR) -> Email & collaboration / Audit / Reports              | Logs related to threat protection: email detections (malware, phishing), Safe Links clicks, Safe Attachments detonations, user-reported messages, investigation and response actions.                    | Defender Portal: Varies by report/feature (e.g., Threat Explorer up to 30 days). <br> Unified Audit Log: Contains some Defender events with UAL retention. <br> Advanced Hunting (E5): Up to 30 days of raw event data.                |
| **Microsoft Defender for Endpoint (MDE) Logs (if M365 E5 or MDE license)** | Microsoft Defender portal (XDR) -> Endpoints / Advanced Hunting / Incidents & Alerts | Device-level security events, alerts, network connections, process creation, file activity, registry changes from enrolled endpoints.                                                       | Advanced Hunting: Up to 30 days of raw event data by default. <br> Can be extended to 180 days with specific licensing. <br> Alerts/Incidents: Retained longer, typically 180 days. <br> Can be streamed to Azure Sentinel or Azure Storage. |
| **Microsoft Defender for Identity Logs (if M365 E5 or standalone)** | Microsoft Defender portal (XDR) -> Identities / Advanced Hunting                          | Monitors on-premises Active Directory signals and Entra ID to detect identity-based threats, lateral movement, and compromised credentials.                                                  | Advanced Hunting: Up to 30 days. Alerts retained longer.                                                                                                                                                                                     |
| **Microsoft Defender for Cloud Apps (MDCA) Logs (if M365 E5 or standalone)** | Microsoft Defender portal (XDR) / MDCA portal (portal.cloudappsecurity.com) -> Investigate -> Activity log | Discovers and controls the use of cloud apps (SaaS discovery), logs user activities in connected apps, detects anomalous behavior, and enforces policies.                               | Activity Log: Default 180 days. <br> Discovery data: 90 days. <br> Can be exported.                                                                                                                                                     |
| **Microsoft Intune (Endpoint Manager) Logs** | Microsoft Intune admin center -> Troubleshooting + support / Audit logs / Device compliance | Device enrollment, compliance status, configuration profiles, app deployment, and admin activities related to endpoint management.                                                              | Audit Logs: Up to 1 year. <br> Operational/Device Logs: Varies, some up to 30 days. <br> Can be exported to Azure Monitor Logs (Log Analytics) for longer retention.                                                                     |
| **Power Platform Audit Logs** | Microsoft Purview compliance portal (Audit search) / Power Platform admin center        | Activities related to Power Apps, Power Automate, and Power BI, including app creation, flow execution, connector usage, and admin changes.                                                       | Same as Unified Audit Log retention. <br> Power Platform admin center may have shorter views for some logs.                                                                                                                                  |
| **Viva Engage (Yammer) Logs** | Microsoft Purview compliance portal (Audit search) / Network Admin -> Export Data       | User activities, group management, settings changes, file activities within Viva Engage.                                                                                                              | Same as Unified Audit Log retention for audited activities. <br> Network export contains more comprehensive data but is a manual process.                                                                                                |

**General Notes on Retention in Microsoft 365:**
* **Unified Audit Log (UAL):** This is the primary source for most user and admin activity across M365. Its retention is key.
* **Licensing Impacts Retention:** M365 E5/G5 licenses or specific add-ons (like E5 Compliance, 10-year audit log retention) significantly extend retention periods for many logs, especially the UAL.
* **Export for Longer Retention:** For logs with shorter default retention or for offline analysis, exporting to Azure Monitor Logs (Log Analytics), Azure Storage, or using the Office 365 Management Activity API for SIEM integration is common practice.
* **Service-Specific Portals:** While the UAL is central, individual service admin centers or portals (Exchange, Teams, Defender) often provide more specialized views or reports for recent activity.
* **Enablement Required:** Some logs, like Mailbox Audit Logs, need to be explicitly enabled or configured for the desired level of detail.
* **Cost Implications:** Storing large volumes of logs externally (e.g., in Azure Storage or Log Analytics) will have cost implications.

This table provides a detailed overview of key log sources within the Microsoft 365 ecosystem relevant for cybersecurity investigations.
