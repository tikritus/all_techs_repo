# Azure Native Technologies: Important Log Sources for Cybersecurity

This document provides a list of crucial log sources from Azure native technologies, their typical locations, descriptions, and information regarding their retention periods, which is vital for cybersecurity investigations.

| Log Source                                  | Azure Service / Location                                       | Description                                                                                                                                                              | Retention Period                                                                                                                                                                 |
|---------------------------------------------|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Identity & Access Management Logs** |                                                                |                                                                                                                                                                          |                                                                                                                                                                                  |
| Microsoft Entra ID Sign-in Logs             | Microsoft Entra ID (Azure portal) -> Monitoring -> Sign-in logs | Records information about user and service principal sign-ins, including application, device, location, and conditional access status.                                   | Default: 30 days (P1/P2 licenses). <br> Free license: 7 days. <br> Can be exported to Azure Monitor Logs (Log Analytics) or Azure Storage for longer, configurable retention.     |
| Microsoft Entra ID Audit Logs               | Microsoft Entra ID (Azure portal) -> Monitoring -> Audit logs   | Provides a trail of all changes made within Microsoft Entra ID, such as user creation, group management, application registration, and policy modifications.               | Default: 30 days (P1/P2 licenses). <br> Free license: 7 days. <br> Can be exported to Azure Monitor Logs (Log Analytics) or Azure Storage for longer, configurable retention.     |
| Microsoft Entra ID Provisioning Logs        | Microsoft Entra ID (Azure portal) -> Monitoring -> Provisioning logs | Tracks activities related to provisioning users and groups from Entra ID to other applications (e.g., SaaS apps).                                                        | Default: 30 days. <br> Can be exported to Azure Monitor Logs or Azure Storage for longer retention.                                                                               |
| **Azure Activity & Monitoring Logs** |                                                                |                                                                                                                                                                          |                                                                                                                                                                                  |
| Azure Activity Log                          | Azure Monitor -> Activity Log                                  | Records subscription-level events, including Azure Resource Manager operational logs (PUT, POST, DELETE), service health events, and autoscale actions.                 | 90 days by default. <br> Can be exported to Azure Monitor Logs (Log Analytics workspace), Azure Storage, or Event Hubs for longer, configurable retention.                            |
| Azure Monitor Logs (Log Analytics)        | Log Analytics workspaces                                       | Centralized repository for collecting logs and performance data from various Azure resources (VMs, App Service, etc.), custom applications, and on-premises systems.     | Default: 30 days. <br> Configurable per table/workspace from 30 days up to 730 days (2 years). Longer retention possible via export to Azure Storage.                               |
| Azure Resource Logs (Diagnostic settings) | Azure Monitor -> Diagnostic settings (per resource)            | Provides insights into the operations of specific Azure resources (e.g., Key Vault audits, Network Security Group events, Web App logs).                                  | Not stored by default. Must be enabled by creating a diagnostic setting to send to Log Analytics, Azure Storage, or Event Hubs. Retention is then based on the destination.          |
| **Network Security Logs** |                                                                |                                                                                                                                                                          |                                                                                                                                                                                  |
| Network Security Group (NSG) Flow Logs    | Network Watcher -> NSG Flow Logs                               | Records information about IP traffic flowing through an NSG, including source/destination IP, port, protocol, and whether traffic was allowed or denied.                | Stored in an Azure Storage account. Retention is managed by user via storage lifecycle policies. <br> Can be sent to Log Analytics via Traffic Analytics for further analysis. |
| Azure Firewall Logs                         | Azure Monitor Logs (Log Analytics) / Azure Storage             | Logs for network traffic, application rules, threat intelligence, and DNS proxy events processed by Azure Firewall.                                                      | Sent via Diagnostic Settings. Retention is based on Log Analytics workspace or Azure Storage account settings.                                                                     |
| Web Application Firewall (WAF) Logs       | Azure Monitor Logs (Log Analytics) / Azure Storage             | Logs requests processed by WAF on Application Gateway or Azure Front Door, including matched rules, actions taken, and request details.                                  | Sent via Diagnostic Settings. Retention is based on Log Analytics workspace or Azure Storage account settings.                                                                     |
| Azure Bastion Audit Logs                    | Azure Monitor Logs (Log Analytics)                             | Records diagnostic information about Bastion sessions, including user connections to VMs.                                                                                | Sent via Diagnostic Settings. Retention is based on Log Analytics workspace settings.                                                                                              |
| **Compute Logs** |                                                                |                                                                                                                                                                          |                                                                                                                                                                                  |
| Virtual Machine (VM) Guest OS Logs        | Azure Monitor Logs (Log Analytics via Azure Monitor Agent) / Azure Storage | OS-level logs from within VMs (Windows Event Logs, Linux Syslog).                                                                                                        | Retention based on Log Analytics workspace settings or Azure Storage account settings if collected there.                                                                        |
| VM Boot Diagnostics                         | Azure Storage Account (managed by Azure)                       | Console output and screenshots for VMs, useful for diagnosing boot failures.                                                                                             | Stored in a user-managed or Azure-managed storage account. Retention managed by user if user-managed.                                                                          |
| App Service Logs                            | Azure Monitor Logs / File System / Azure Storage               | Includes application logs, web server logs (IIS), detailed error messages, failed request tracing for Azure App Service.                                                 | File System: Limited size/time. <br> Azure Storage: User-defined retention. <br> Azure Monitor Logs: Configurable retention.                                                       |
| Azure Functions Logs                        | Application Insights / Azure Monitor Logs / Azure Storage      | Execution logs, `stdout`/`stderr`, custom application logs, and performance data for Azure Functions.                                                                  | Application Insights: Default 90 days, configurable up to 730 days. <br> Azure Monitor Logs: Configurable. <br> Azure Storage: User-defined.                                        |
| **Storage Logs** |                                                                |                                                                                                                                                                          |                                                                                                                                                                                  |
| Azure Storage Analytics Logs (Classic)    | `$logs` blob container in the storage account                  | Logs successful and failed requests to Azure Blob, Table, and Queue storage. (Legacy, recommend Azure Monitor for Storage)                                              | User-defined via data retention policy (1 to 365 days, or never delete).                                                                                                         |
| Azure Monitor for Storage                   | Azure Monitor Logs (Log Analytics)                             | Provides comprehensive monitoring of Azure Storage accounts by collecting metrics and logs, including transaction details and capacity.                                  | Retention based on Log Analytics workspace settings.                                                                                                                               |
| **Database Logs** |                                                                |                                                                                                                                                                          |                                                                                                                                                                                  |
| Azure SQL Database / Managed Instance Audit Logs | Azure Storage / Log Analytics / Event Hubs                   | Tracks database events and writes them to an audit log. Can include DDL, DML, logins, etc.                                                                               | Sent via Diagnostic Settings or server/database audit settings. Retention based on destination (Storage, Log Analytics).                                                             |
| Azure Cosmos DB Diagnostic Logs             | Azure Monitor Logs / Azure Storage / Event Hubs                | Logs for data plane requests (CRUD operations), control plane operations, query runtime statistics, and RU consumption.                                                  | Sent via Diagnostic Settings. Retention based on destination.                                                                                                                      |
| **Security & Threat Detection Logs** |                                                                |                                                                                                                                                                          |                                                                                                                                                                                  |
| Microsoft Defender for Cloud Alerts       | Microsoft Defender for Cloud portal / Azure Monitor Logs       | Security alerts generated by Defender for Cloud based on analysis of logs and configurations across Azure resources, hybrid, and multi-cloud environments.               | Defender for Cloud portal: 90 days. <br> Azure Monitor Logs (if exported): Configurable retention.                                                                               |
| Microsoft Sentinel Incidents & Logs       | Microsoft Sentinel (Log Analytics workspace)                   | Security incidents and raw logs collected from various data connectors (Azure services, Microsoft 365, third-party solutions) for SIEM/SOAR capabilities.              | Retention based on the underlying Log Analytics workspace settings (default 30 days, configurable up to 730 days, or longer with archive).                                          |
| Azure Key Vault Diagnostic Logs             | Azure Monitor Logs / Azure Storage / Event Hubs                | Audit events showing 'who', 'what', and 'when' for operations performed on Key Vault secrets, keys, and certificates.                                                    | Sent via Diagnostic Settings. Retention based on destination.                                                                                                                      |
| **Container Service Logs** |                                                                |                                                                                                                                                                          |                                                                                                                                                                                  |
| Azure Kubernetes Service (AKS) Control Plane Logs | Azure Monitor Logs (Log Analytics)                         | Logs from AKS control plane components: API server, Controller Manager, Scheduler, etcd (if enabled), and Cluster Autoscaler.                                          | Sent via Diagnostic Settings for the AKS cluster. Retention based on Log Analytics workspace settings.                                                                           |
| AKS Node & Pod Logs                         | Azure Monitor Logs (Container insights) / Azure Storage        | Logs from worker nodes (kubelet, container runtime) and application logs (`stdout`/`stderr`) from pods running in AKS.                                                 | Container Insights (Azure Monitor Logs): Configurable retention. <br> Custom logging to Azure Storage: User-defined.                                                              |
| Azure Container Instances (ACI) Logs      | Azure Monitor Logs / Azure Storage                             | Logs from containers running in ACI, including `stdout` and `stderr`.                                                                                                  | Accessible via `az container logs` CLI or through Diagnostic Settings to Log Analytics/Storage. Retention based on destination.                                                    |
| Azure Container Registry (ACR) Logs       | Azure Monitor Logs / Azure Storage                             | Logs for ACR operations such as image push/pull, authentication events, and repository management.                                                                       | Sent via Diagnostic Settings. Retention based on destination.                                                                                                                      |

**General Notes on Retention in Azure:**
* **Diagnostic Settings:** Many Azure services require configuring "Diagnostic settings" to forward their logs to a durable storage solution like Azure Monitor Logs (Log Analytics), Azure Storage, or Azure Event Hubs. Retention is then managed at the destination.
* **Azure Monitor Logs (Log Analytics):** Offers configurable retention per table or for the entire workspace. Data can also be archived for longer-term, lower-cost storage.
* **Azure Storage:** When logs are sent to Azure Storage, retention is typically managed using Blob Lifecycle Management policies.
* **Service Defaults:** Some services might have very short-term internal buffers for logs if not explicitly configured for export.
* **Cost Implications:** Log storage and ingestion can incur costs. Plan retention policies based on security, compliance, and budget requirements.
* **Compliance Requirements:** Organizational and regulatory compliance (e.g., GDPR, HIPAA, PCI DSS) often dictate minimum log retention periods.

This table provides a comprehensive overview of key log sources in Azure, focusing on their relevance to cybersecurity investigations and retention characteristics.
