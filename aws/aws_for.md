# AWS Native Technologies: Important Log Sources for Cybersecurity

This document provides a list of crucial log sources from AWS native technologies, their typical locations, descriptions, and information regarding their retention periods, which is vital for cybersecurity investigations.

|Log Source                      | AWS Service / Location                                       | Description                                                                                                                                | Retention Period                                                                                                                               |
|---------------------------------|--------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|
| **API Activity & Monitoring** |                                                              |                                                                                                                                            |                                                                                                                                                |
| CloudTrail Logs                 | S3 Bucket (configured in CloudTrail), CloudWatch Logs        | Records AWS API calls, console actions, SDK/CLI calls, and AWS service actions. Essential for tracking all account activity and changes.   | Event History: 90 days. <br> S3: User-defined via S3 lifecycle policies (can be indefinite). <br> CloudWatch Logs: Configurable (1 day to 10 years, or Never Expire). |
| CloudWatch Logs                 | CloudWatch Logs (Log Groups for various services)            | Centralized logging for many AWS services, custom application logs from EC2, Lambda execution logs, VPC Flow Logs, Route 53 logs, etc.    | Default: Never Expire. <br> Configurable per Log Group (1 day to 10 years, or Never Expire).                                                    |
| **Network Artifacts** |                                                              |                                                                                                                                            |                                                                                                                                                |
| VPC Flow Logs                   | CloudWatch Logs or S3 Bucket (configured per VPC/Subnet/ENI) | Captures IP traffic information for network interfaces in your VPC (source/destination IP, ports, protocol, packets, bytes, action).       | Published to CloudWatch Logs: Configurable retention. <br> Published to S3: User-defined via S3 lifecycle policies.                               |
| ELB Access Logs (ALB/CLB/NLB) | S3 Bucket (configured per Load Balancer)                     | Detailed information about requests sent to your Load Balancers (timestamp, client IP, latencies, request paths, server responses).          | User-defined via S3 lifecycle policies on the target bucket.                                                                                     |
| Route 53 DNS Query Logs         | CloudWatch Logs (configured per Hosted Zone)                 | Logs DNS queries received by Amazon Route 53, including domain queried, record type, and requester's IP.                                 | Configurable per Log Group in CloudWatch Logs (1 day to 10 years, or Never Expire).                                                              |
| **Compute Logs** |                                                              |                                                                                                                                            |                                                                                                                                                |
| EC2 Instance System Logs        | EC2 Console (Instance Settings -> Get System Log) / CloudWatch Logs (if using CloudWatch Agent) | Output from the instance's console (boot issues, kernel messages). OS-level logs are separate.                                                | Console: Limited buffer. <br> CloudWatch Logs: Configurable retention if sent via Agent.                                                         |
| Lambda Function Logs            | CloudWatch Logs                                              | Output from Lambda function executions, including `stdout`, `stderr`, custom logging, and execution metadata (duration, memory used).      | Configurable per Log Group in CloudWatch Logs (1 day to 10 years, or Never Expire).                                                              |
| **Storage Logs** |                                                              |                                                                                                                                            |                                                                                                                                                |
| S3 Server Access Logs           | S3 Bucket (configured per source S3 bucket)                  | Detailed records for requests made to an S3 bucket (requester, bucket name, time, request action, HTTP status, error codes).             | User-defined via S3 lifecycle policies on the target bucket.                                                                                     |
| **Database Logs** |                                                              |                                                                                                                                            |                                                                                                                                                |
| RDS Database Logs               | RDS Console (Logs & events section), CloudWatch Logs         | Engine-specific logs (e.g., error log, slow query log, general log, audit log if enabled) for relational database instances.             | RDS Instance: Varies by engine, typically short-term (e.g., 7 days). <br> CloudWatch Logs: Configurable retention if exported.                     |
| Aurora Audit Logs               | CloudWatch Logs (if enabled)                                 | Auditing for Amazon Aurora databases, tracking database events like connections, queries, DDL/DML statements, and administrative actions. | Configurable per Log Group in CloudWatch Logs (1 day to 10 years, or Never Expire).                                                              |
| DynamoDB (Data Plane via CloudTrail) | CloudTrail                                               | Data plane operations for DynamoDB (e.g., `GetItem`, `PutItem`, `DeleteItem`) can be logged to CloudTrail if data events are enabled.    | Same as CloudTrail Logs (Event History: 90 days; S3: User-defined).                                                                              |
| **Security & Threat Detection Logs** |                                                          |                                                                                                                                            |                                                                                                                                                |
| GuardDuty Findings              | GuardDuty Console, CloudWatch Events, S3 (optional export)   | Security findings from AWS's managed threat detection service.                                                                             | GuardDuty Console: 90 days. <br> S3 (if exported): User-defined via S3 lifecycle policies. <br> CloudWatch Events: 90 days for matched events.     |
| AWS WAF Logs                    | CloudWatch Logs or Kinesis Data Firehose (to S3, etc.)       | Logs web requests that AWS Web Application Firewall inspects, including matched rules and actions taken.                                   | CloudWatch Logs: Configurable retention. <br> Kinesis to S3: User-defined S3 lifecycle policies.                                                   |
| AWS Config History              | S3 Bucket (if configured)                                    | Records configuration items for supported AWS resources as .json files. Provides a history of resource configurations.                 | User-defined via S3 lifecycle policies on the delivery channel's S3 bucket.                                                                      |
| **Container Service Logs** |                                                              |                                                                                                                                            |                                                                                                                                                |
| ECS Task/Fargate Task Logs      | CloudWatch Logs (default for many configurations)            | Application logs (`stdout`/`stderr`) from containers running on ECS (EC2/Fargate).                                                       | Configurable per Log Group in CloudWatch Logs (1 day to 10 years, or Never Expire).                                                              |
| EKS Pod Logs                    | CloudWatch Logs (via Fluentd, Fluent Bit, or other forwarders) | Application logs (`stdout`/`stderr`) from containers running in EKS Pods (on EC2/Fargate).                                               | Configurable per Log Group in CloudWatch Logs (1 day to 10 years, or Never Expire).                                                              |
| EKS Control Plane Logs          | CloudWatch Logs (configurable per EKS cluster)               | Logs from the Kubernetes control plane components managed by AWS for EKS (API server, Audit, Authenticator, Controller manager, Scheduler). | Configurable per Log Group in CloudWatch Logs (1 day to 10 years, or Never Expire).                                                              |

**General Notes on Retention:**
* **User-Configurable:** For services logging to S3 or CloudWatch Logs, the retention period is often highly configurable by the user. It's crucial to verify the specific retention settings in your environment.
* **S3 Lifecycle Policies:** When logs are stored in S3, retention is managed via S3 Lifecycle policies, which can transition objects to different storage classes or delete them after a specified period.
* **CloudWatch Logs Retention Policies:** Each CloudWatch Log Group can have its own retention policy.
* **Service-Specific Defaults:** Some services might have internal, short-term retention for operational purposes (e.g., EC2 system log buffer) that are separate from long-term archival logging.
* **Cost Implications:** Longer retention periods generally incur higher storage costs. Balance retention needs with budget.
* **Compliance Requirements:** Your organization's compliance obligations (e.g., PCI DSS, HIPAA) may dictate minimum log retention periods.

This table should help you quickly identify key log sources and understand their retention characteristics within AWS for your cybersecurity investigations.
